{"ast":null,"code":"import _regeneratorRuntime from\"/home/ricardo/bankpague/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/ricardo/bankpague/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/ricardo/bankpague/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useRef,useCallback,useState}from'react';import{FiLogIn,FiMail}from'react-icons/fi';import{Form}from'@unform/web';import{Link}from'react-router-dom';import*as Yup from'yup';import getValidationErrors from\"../../utils/getValidationErrors\";import api from\"../../services/api\";import{useToast}from\"../../hooks/ToastContext\";import Input from\"../../components/Input\";import Button from\"../../components/Button\";import logoImg from\"../../assets/logo.svg\";import{Container,Content,AnimationContainer,Background}from'./styles';var ForgotPassword=function ForgotPassword(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var formRef=useRef(null);var _useToast=useToast(),addToast=_useToast.addToast;var handleSubmit=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var _formRef$current,schema,_formRef$current2,errors;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setLoading(true);(_formRef$current=formRef.current)===null||_formRef$current===void 0?void 0:_formRef$current.setErrors({});schema=Yup.object().shape({email:Yup.string().required('E-mail obrigatório').email('Digite um e-mail válido')});_context.next=6;return schema.validate(data,{abortEarly:false});case 6:_context.next=8;return api.post('/password/forgot',{email:data.email});case 8:addToast({type:'success',title:'E-mail de recupereção enviado',description:'Enviamos um e-mail para sua caixa de entrada com as instruções para recuperar a sua senha'});_context.next=18;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);if(!(_context.t0 instanceof Yup.ValidationError)){_context.next=17;break;}errors=getValidationErrors(_context.t0);(_formRef$current2=formRef.current)===null||_formRef$current2===void 0?void 0:_formRef$current2.setErrors(errors);return _context.abrupt(\"return\");case 17:addToast({type:'error',title:'Erro na recuperação de senha',description:'Ocorreu um erro ao tentar realizar a recuperação de senha, tente novamente.'});case 18:_context.prev=18;setLoading(false);return _context.finish(18);case 21:case\"end\":return _context.stop();}}},_callee,null,[[0,11,18,21]]);}));return function(_x){return _ref.apply(this,arguments);};}(),[addToast]);return/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Content,null,/*#__PURE__*/React.createElement(AnimationContainer,null,/*#__PURE__*/React.createElement(\"img\",{src:logoImg,alt:\"Go Barber\"}),/*#__PURE__*/React.createElement(Form,{ref:formRef,onSubmit:handleSubmit},/*#__PURE__*/React.createElement(\"h1\",null,\"Recuperar Senha\"),/*#__PURE__*/React.createElement(Input,{name:\"email\",type:\"email\",placeholder:\"E-mail\",icon:FiMail}),/*#__PURE__*/React.createElement(Button,{type:\"submit\",loading:loading},\"Recuperar\")),/*#__PURE__*/React.createElement(Link,{to:\"/\"},/*#__PURE__*/React.createElement(FiLogIn,null),\"Voltar ao Login\"))),/*#__PURE__*/React.createElement(Background,null));};export default ForgotPassword;","map":{"version":3,"sources":["/home/ricardo/bankpague/front/src/pages/ForgotPassword/index.tsx"],"names":["React","useRef","useCallback","useState","FiLogIn","FiMail","Form","Link","Yup","getValidationErrors","api","useToast","Input","Button","Container","Content","AnimationContainer","Background","ForgotPassword","loading","setLoading","formRef","addToast","handleSubmit","data","current","setErrors","schema","object","shape","email","string","required","validate","abortEarly","post","type","title","description","ValidationError","errors","logoImg"],"mappings":"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","sourcesContent":["import React, { useRef, useCallback, useState } from 'react';\nimport { FiLogIn, FiMail } from 'react-icons/fi';\nimport { FormHandles } from '@unform/core';\nimport { Form } from '@unform/web';\nimport { Link } from 'react-router-dom';\n\nimport * as Yup from 'yup';\nimport getValidationErrors from '~/utils/getValidationErrors';\n\nimport api from '~/services/api';\n\nimport { useToast } from '~/hooks/ToastContext';\n\nimport IForgotPasswordFormData from './interfaces/IForgotPasswordFormData';\n\nimport Input from '~/components/Input';\nimport Button from '~/components/Button';\n\nimport logoImg from '~/assets/logo.svg';\n\nimport { Container, Content, AnimationContainer, Background } from './styles';\n\nconst ForgotPassword: React.FC = () => {\n  const [loading, setLoading] = useState(false);\n  const formRef = useRef<FormHandles>(null);\n\n  const { addToast } = useToast();\n\n  const handleSubmit = useCallback(\n    async (data: IForgotPasswordFormData) => {\n      try {\n        setLoading(true);\n\n        formRef.current?.setErrors({});\n\n        const schema = Yup.object().shape({\n          email: Yup.string()\n            .required('E-mail obrigatório')\n            .email('Digite um e-mail válido'),\n        });\n\n        await schema.validate(data, {\n          abortEarly: false,\n        });\n\n        await api.post('/password/forgot', {\n          email: data.email,\n        });\n\n        addToast({\n          type: 'success',\n          title: 'E-mail de recupereção enviado',\n          description:\n            'Enviamos um e-mail para sua caixa de entrada com as instruções para recuperar a sua senha',\n        });\n      } catch (err) {\n        if (err instanceof Yup.ValidationError) {\n          const errors = getValidationErrors(err);\n\n          formRef.current?.setErrors(errors);\n\n          return;\n        }\n\n        addToast({\n          type: 'error',\n          title: 'Erro na recuperação de senha',\n          description:\n            'Ocorreu um erro ao tentar realizar a recuperação de senha, tente novamente.',\n        });\n      } finally {\n        setLoading(false);\n      }\n    },\n    [addToast],\n  );\n\n  return (\n    <Container>\n      <Content>\n        <AnimationContainer>\n          <img src={logoImg} alt=\"Go Barber\" />\n\n          <Form ref={formRef} onSubmit={handleSubmit}>\n            <h1>Recuperar Senha</h1>\n\n            <Input\n              name=\"email\"\n              type=\"email\"\n              placeholder=\"E-mail\"\n              icon={FiMail}\n            />\n\n            <Button type=\"submit\" loading={loading}>\n              Recuperar\n            </Button>\n          </Form>\n\n          <Link to=\"/\">\n            <FiLogIn />\n            Voltar ao Login\n          </Link>\n        </AnimationContainer>\n      </Content>\n      <Background />\n    </Container>\n  );\n};\n\nexport default ForgotPassword;\n"]},"metadata":{},"sourceType":"module"}