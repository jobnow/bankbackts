{"ast":null,"code":"import _regeneratorRuntime from\"/home/ricardo/bankpague/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/ricardo/bankpague/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useRef,useCallback}from'react';import{Lock,Mail,LogIn}from'react-feather';import{Form}from'@unform/web';import{Link,useHistory}from'react-router-dom';import*as Yup from'yup';import getValidationErrors from\"../../utils/getValidationErrors\";import{useAuth}from\"../../hooks/AuthContext\";import{useToast}from\"../../hooks/ToastContext\";import Input from\"../../components/Input\";import Button from\"../../components/Button\";import logoImg from\"../../assets/logo.png\";import{Container,Content,AnimationContainer}from'./styles';var SignIn=function SignIn(){var formRef=useRef(null);var history=useHistory();var _useAuth=useAuth(),signIn=_useAuth.signIn;var _useToast=useToast(),addToast=_useToast.addToast;var handleSubmit=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var _formRef$current,schema,_formRef$current2,errors;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;(_formRef$current=formRef.current)===null||_formRef$current===void 0?void 0:_formRef$current.setErrors({});schema=Yup.object().shape({email:Yup.string().required('E-mail obrigatório').email('Digite um e-mail válido'),password:Yup.string().required('Senha obrigatória')});_context.next=5;return schema.validate(data,{abortEarly:false});case 5:_context.next=7;return signIn({email:data.email,password:data.password});case 7:history.push('/dashboard');_context.next=17;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);if(!(_context.t0 instanceof Yup.ValidationError)){_context.next=16;break;}errors=getValidationErrors(_context.t0);(_formRef$current2=formRef.current)===null||_formRef$current2===void 0?void 0:_formRef$current2.setErrors(errors);return _context.abrupt(\"return\");case 16:addToast({type:'error',title:'Erro na autenticação',description:'Ocorreu um erro ao fazer login, cheque as credenciais.'});case 17:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function(_x){return _ref.apply(this,arguments);};}(),[signIn,history,addToast]);return/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Content,null,/*#__PURE__*/React.createElement(AnimationContainer,null,/*#__PURE__*/React.createElement(\"img\",{src:logoImg,alt:\"Bank Pague\"}),/*#__PURE__*/React.createElement(Form,{ref:formRef,onSubmit:handleSubmit},/*#__PURE__*/React.createElement(Input,{name:\"email\",type:\"text\",placeholder:\"E-mail\",icon:Mail}),/*#__PURE__*/React.createElement(Input,{name:\"password\",type:\"password\",placeholder:\"Senha\",icon:Lock}),/*#__PURE__*/React.createElement(Button,{type:\"submit\"},\"Acessar\"),/*#__PURE__*/React.createElement(Link,{to:\"/forgot-password\"},\"Esqueci minha senha\")),/*#__PURE__*/React.createElement(Link,{to:\"signup\"},/*#__PURE__*/React.createElement(LogIn,null),\"Criar conta\"))));};export default SignIn;","map":{"version":3,"sources":["/home/ricardo/bankpague/front/src/pages/SignIn/index.tsx"],"names":["React","useRef","useCallback","Lock","Mail","LogIn","Form","Link","useHistory","Yup","getValidationErrors","useAuth","useToast","Input","Button","logoImg","Container","Content","AnimationContainer","SignIn","formRef","history","signIn","addToast","handleSubmit","data","current","setErrors","schema","object","shape","email","string","required","password","validate","abortEarly","push","ValidationError","errors","type","title","description"],"mappings":"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","sourcesContent":["import React, { useRef, useCallback } from 'react';\nimport { Lock, Mail, LogIn } from 'react-feather';\nimport { FormHandles } from '@unform/core';\nimport { Form } from '@unform/web';\nimport { Link, useHistory } from 'react-router-dom';\n\nimport * as Yup from 'yup';\nimport getValidationErrors from '~/utils/getValidationErrors';\n\nimport { useAuth } from '~/hooks/AuthContext';\nimport { useToast } from '~/hooks/ToastContext';\n\nimport ISignInFormData from './interfaces/ISignInFormData';\n\nimport Input from '~/components/Input';\nimport Button from '~/components/Button';\n\nimport logoImg from '~/assets/logo.png';\n\nimport { Container, Content, AnimationContainer } from './styles';\n\nconst SignIn: React.FC = () => {\n  const formRef = useRef<FormHandles>(null);\n  const history = useHistory();\n\n  const { signIn } = useAuth();\n  const { addToast } = useToast();\n\n  const handleSubmit = useCallback(\n    async (data: ISignInFormData) => {\n      try {\n        formRef.current?.setErrors({});\n\n        const schema = Yup.object().shape({\n          email: Yup.string()\n            .required('E-mail obrigatório')\n            .email('Digite um e-mail válido'),\n          password: Yup.string().required('Senha obrigatória'),\n        });\n\n        await schema.validate(data, {\n          abortEarly: false,\n        });\n\n        await signIn({\n          email: data.email,\n          password: data.password,\n        });\n\n        history.push('/dashboard');\n      } catch (err) {\n        if (err instanceof Yup.ValidationError) {\n          const errors = getValidationErrors(err);\n\n          formRef.current?.setErrors(errors);\n\n          return;\n        }\n\n        addToast({\n          type: 'error',\n          title: 'Erro na autenticação',\n          description: 'Ocorreu um erro ao fazer login, cheque as credenciais.',\n        });\n      }\n    },\n    [signIn, history, addToast],\n  );\n\n  return (\n    <Container>\n      <Content>\n        <AnimationContainer>\n          <img src={logoImg} alt=\"Bank Pague\" />\n\n          <Form ref={formRef} onSubmit={handleSubmit}>\n\n            <Input\n              name=\"email\"\n              type=\"text\"\n              placeholder=\"E-mail\"\n              icon={Mail}\n            />\n            <Input\n              name=\"password\"\n              type=\"password\"\n              placeholder=\"Senha\"\n              icon={Lock}\n            />\n\n            <Button type=\"submit\">Acessar</Button>\n\n            <Link to=\"/forgot-password\">Esqueci minha senha</Link>\n          </Form>\n\n          <Link to=\"signup\">\n            <LogIn />\n            Criar conta\n          </Link>\n        </AnimationContainer>\n      </Content>\n    </Container>\n  );\n};\n\nexport default SignIn;\n"]},"metadata":{},"sourceType":"module"}