{"ast":null,"code":"import _regeneratorRuntime from\"/home/ricardo/bankpague/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/ricardo/bankpague/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useCallback,useRef}from'react';import{FiArrowLeft,FiMail,FiUser,FiLock}from'react-icons/fi';import{Form}from'@unform/web';import{Link,useHistory}from'react-router-dom';import*as Yup from'yup';import{useToast}from\"../../hooks/ToastContext\";import api from\"../../services/api\";import getValidationErrors from\"../../utils/getValidationErrors\";import Input from\"../../components/Input\";import Button from\"../../components/Button\";import logoImg from\"../../assets/logo.svg\";import{Container,Content,AnimationContainer,Background}from'./styles';var SignUp=function SignUp(){var formRef=useRef(null);var history=useHistory();var _useToast=useToast(),addToast=_useToast.addToast;var handleSubmit=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var _formRef$current,schema,_formRef$current2,errors;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;(_formRef$current=formRef.current)===null||_formRef$current===void 0?void 0:_formRef$current.setErrors({});schema=Yup.object().shape({name:Yup.string().required('Nome obrigatório'),email:Yup.string().required('E-mail obrigatório').email('Digite um e-mail válido'),password:Yup.string().min(6,'Digite uma senha de no mínimo 6 dígitos')});_context.next=5;return schema.validate(data,{abortEarly:false});case 5:_context.next=7;return api.post('/users',data);case 7:history.push('/');addToast({type:'success',title:'Cadastro realizado! ✂️',description:'Você já pode fazer seu logon no GoBarber!'});_context.next=19;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);if(!(_context.t0 instanceof Yup.ValidationError)){_context.next=18;break;}errors=getValidationErrors(_context.t0);console.log(errors);(_formRef$current2=formRef.current)===null||_formRef$current2===void 0?void 0:_formRef$current2.setErrors(errors);return _context.abrupt(\"return\");case 18:addToast({type:'error',title:'Erro no cadastro',description:'Ocorreu um erro ao fazer cadastro, tente novamente.'});case 19:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function(_x){return _ref.apply(this,arguments);};}(),[addToast,history]);return/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Background,null),/*#__PURE__*/React.createElement(Content,null,/*#__PURE__*/React.createElement(AnimationContainer,null,/*#__PURE__*/React.createElement(\"img\",{src:logoImg,alt:\"Go Barber\"}),/*#__PURE__*/React.createElement(Form,{ref:formRef,onSubmit:handleSubmit},/*#__PURE__*/React.createElement(\"h1\",null,\"Fa\\xE7a seu cadastro\"),/*#__PURE__*/React.createElement(Input,{name:\"name\",placeholder:\"Nome\",icon:FiUser}),/*#__PURE__*/React.createElement(Input,{name:\"email\",type:\"email\",placeholder:\"E-mail\",icon:FiMail}),/*#__PURE__*/React.createElement(Input,{name:\"password\",type:\"password\",placeholder:\"Senha\",icon:FiLock}),/*#__PURE__*/React.createElement(Button,{type:\"submit\"},\"Cadastrar\")),/*#__PURE__*/React.createElement(Link,{to:\"/\"},/*#__PURE__*/React.createElement(FiArrowLeft,null),\"Voltar para Logon\"))));};export default SignUp;","map":{"version":3,"sources":["/home/ricardo/bankpague/front/src/pages/SignUp/index.tsx"],"names":["React","useCallback","useRef","FiArrowLeft","FiMail","FiUser","FiLock","Form","Link","useHistory","Yup","useToast","api","getValidationErrors","Input","Button","Container","Content","AnimationContainer","Background","SignUp","formRef","history","addToast","handleSubmit","data","current","setErrors","schema","object","shape","name","string","required","email","password","min","validate","abortEarly","post","push","type","title","description","ValidationError","errors","console","log","logoImg"],"mappings":"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","sourcesContent":["import React, { useCallback, useRef } from 'react';\nimport { FiArrowLeft, FiMail, FiUser, FiLock } from 'react-icons/fi';\nimport { FormHandles } from '@unform/core';\nimport { Form } from '@unform/web';\nimport { Link, useHistory } from 'react-router-dom';\n\nimport * as Yup from 'yup';\nimport { useToast } from '~/hooks/ToastContext';\n\nimport api from '~/services/api';\nimport getValidationErrors from '~/utils/getValidationErrors';\n\nimport ISignUpFormData from './interfaces/ISignUpFormData';\n\nimport Input from '~/components/Input';\nimport Button from '~/components/Button';\n\nimport logoImg from '~/assets/logo.svg';\n\nimport { Container, Content, AnimationContainer, Background } from './styles';\n\nconst SignUp: React.FC = () => {\n  const formRef = useRef<FormHandles>(null);\n  const history = useHistory();\n\n  const { addToast } = useToast();\n\n  const handleSubmit = useCallback(\n    async (data: ISignUpFormData) => {\n      try {\n        formRef.current?.setErrors({});\n\n        const schema = Yup.object().shape({\n          name: Yup.string().required('Nome obrigatório'),\n          email: Yup.string()\n            .required('E-mail obrigatório')\n            .email('Digite um e-mail válido'),\n          password: Yup.string().min(\n            6,\n            'Digite uma senha de no mínimo 6 dígitos',\n          ),\n        });\n\n        await schema.validate(data, {\n          abortEarly: false,\n        });\n\n        await api.post('/users', data);\n\n        history.push('/');\n\n        addToast({\n          type: 'success',\n          title: 'Cadastro realizado! ✂️',\n          description: 'Você já pode fazer seu logon no GoBarber!',\n        });\n      } catch (err) {\n        if (err instanceof Yup.ValidationError) {\n          const errors = getValidationErrors(err);\n          console.log(errors);\n\n          formRef.current?.setErrors(errors);\n\n          return;\n        }\n\n        addToast({\n          type: 'error',\n          title: 'Erro no cadastro',\n          description: 'Ocorreu um erro ao fazer cadastro, tente novamente.',\n        });\n      }\n    },\n    [addToast, history],\n  );\n\n  return (\n    <Container>\n      <Background />\n\n      <Content>\n        <AnimationContainer>\n          <img src={logoImg} alt=\"Go Barber\" />\n\n          <Form ref={formRef} onSubmit={handleSubmit}>\n            <h1>Faça seu cadastro</h1>\n\n            <Input name=\"name\" placeholder=\"Nome\" icon={FiUser} />\n            <Input\n              name=\"email\"\n              type=\"email\"\n              placeholder=\"E-mail\"\n              icon={FiMail}\n            />\n            <Input\n              name=\"password\"\n              type=\"password\"\n              placeholder=\"Senha\"\n              icon={FiLock}\n            />\n\n            <Button type=\"submit\">Cadastrar</Button>\n          </Form>\n\n          <Link to=\"/\">\n            <FiArrowLeft />\n            Voltar para Logon\n          </Link>\n        </AnimationContainer>\n      </Content>\n    </Container>\n  );\n};\n\nexport default SignUp;\n"]},"metadata":{},"sourceType":"module"}